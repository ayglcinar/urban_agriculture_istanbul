<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title></title>
    <meta
      name="viewport"
      content="initial-scale=1,maximum-scale=1,user-scalable=no" />
    <script src="https://api.tiles.mapbox.com/mapbox-gl-js/v1.4.0/mapbox-gl.js"></script>
    <link href="https://api.tiles.mapbox.com/mapbox-gl-js/v1.4.0/mapbox-gl.css" rel="stylesheet"/>
    <link
      href="https://fonts.googleapis.com/css?family=PT+Sans"
      rel="stylesheet"
      type="text/css" />
    <style>
      body { margin: 0; padding: 0; }
      #map { position: fixed; top: 0; bottom: 0; width: 50%;}
      img { max-width: 100%; height: auto;}
      div { font-family: "PT Sans", sans-serif;}
    </style>
     
  </head>

  <body>
    
    <style>
      #features {
        width: 50%;
        margin-left: 50%;
        font-family: "PT Sans", sans-serif;
        overflow-y: scroll;
        background-color: #fafafa;
      }
      section {
        padding: 25px 50px;
        line-height: 25px;
        border-bottom: 1px solid #ddd;
        opacity: 0.25;
        font-size: 13px;
      }
      section.active {
        opacity: 1;
      }
      section:last-child {
        border-bottom: none;
        margin-bottom: 400px;
      }
    </style>

    <div id='map'></div> <!-- check -->
        <div id='features'>
        <section id='intro' class='active'>
        <h3>Beyoğlu'nda Çocuk</h3>
        <p> ** açıklama** </p>
          </section>
          
    <section id="1">
        <h3>Gezi Parkı</h3>
        <img src="//uploads.knightlab.com/storymapjs/fbb70813e6869662a52896a717be1b4e/sites-of-memory/_images/Tal el Zaatar - Photo by almashriq_Fotor.jpg"/>
        <p>tanım <br/></p>
        <a href="http://mapofmemorylebanon.webflow.io/en/sites/tal-el-zaatar" target="_blank" rel="">Okumaya devam et</a>
      </section>

    <section id="2">
        <h3>Gezi Parkı</h3>
        <img src=""/>
        <p>tanım <br/></p>
        <a href="http://mapofmemorylebanon.webflow.io/en/sites/tal-el-zaatar" target="_blank" rel="">Okumaya devam et</a>
      </section>

    <section id="3">
        <h3>Gezi Parkı</h3>
        <img src=""/>
        <p>tanım <br/></p>
        <a href="http://mapofmemorylebanon.webflow.io/en/sites/tal-el-zaatar" target="_blank" rel="">Okumaya devam et</a>
      </section>

    
    </div>

      <script>

    mapboxgl.accessToken = 'pk.eyJ1IjoiYXNwZWwxNiIsImEiOiJjazFrcTFreWQxaWQwM25wNnB5OGtob2cyIn0.z-P2ljsucUiDSe9lpECDMA';

    var map = window.map = new mapboxgl.Map({
        container: 'map',
        style: 'mapbox://styles/aspel16/ck45gz86a1y101dt6k13dbdzv',
        center: [28.977505, 41.036864],
        zoom: 6,
        bearing: -17.6,
        pitch: 45,
        hash: true,
        container: 'map',
        antialias: true }
    );

    // Display buildings in 3D
    map.on('load', function() {

    var layers = map.getStyle().layers;
    var labelLayerId;
    for (var i = 0; i < layers.length; i++) {
        if (layers[i].type === 'symbol' && layers[i].layout['text-field']) {
            labelLayerId = layers[i].id; 
            break; 
    }}

    map.addLayer({
        'id': '3d-buildings',
        'source': 'composite',
        'source-layer': 'building',
        'filter': ['==', 'extrude', 'true'],
        'type': 'fill-extrusion',
        'minzoom': 15,
        'paint': {
        'fill-extrusion-color': '#aaa',
        // use an 'interpolate' expression to add a smooth transition effect to the
        // buildings as the user zooms in
        'fill-extrusion-height': ["interpolate", ["linear"], ["zoom"], 15, 0, 15.05, ["get", "height"]],
        'fill-extrusion-base': ["interpolate", ["linear"], ["zoom"], 15, 0, 15.05, ["get", "min_height"]],
        'fill-extrusion-opacity': .6 }
    }, labelLayerId); });    
        
    // SECTIONS
    var chapters = {
        'intro': {
        bearing: 0,
        center: [28.977505, 41.036864],
        zoom: 9.48,
        bearing: 24.3,
        pitch: 0,
        },
        '1': {
        duration: 6000,
        center: [28.986663, 41.037972],
        bearing: -30,
        zoom: 15.5,
        pitch: 30
        },
        '2': {
        bearing: 0,
        center: [28.984649, 41.034873],
        bearing: 0,
        zoom: 16,
        pitch: 0,
        speed: 0.3
        },
        '3': {
        duration: 6000,
        center: [28.986663, 41.037972],
        bearing: -30,
        zoom: 15.5,
        pitch: 30
        }      
        };

      

    //Function to run the story
    // On every scroll event, check which element is on screen
    window.onscroll = function() {
        var chapterNames = Object.keys(chapters);
        for (var i = 0; i < chapterNames.length; i++) {
            var chapterName = chapterNames[i];
                if (isElementOnScreen(chapterName)) {
                    setActiveChapter(chapterName);
                    break; }}
    };
    var activeChapterName = 'intro'; //Change this to match the first chapter of your story
    function setActiveChapter(chapterName) {
        if (chapterName === activeChapterName) return;
        map.flyTo(chapters[chapterName]);
        document.getElementById(chapterName).setAttribute('class', 'active');
        document.getElementById(activeChapterName).setAttribute('class', '');
        activeChapterName = chapterName;
    }
    function isElementOnScreen(id) {
        var element = document.getElementById(id);
        var bounds = element.getBoundingClientRect();
        return bounds.top < window.innerHeight && bounds.bottom > 0;
    }

</script>

</body>
</html>
